<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>Cloudflare AI Chat</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        select, textarea, button { width: 100%; margin-bottom: 10px; padding: 10px; }
        #responseOutput { margin-top: 20px; white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>Cloudflare AI Chat</h1>
    <select id="modelSelect"></select>
    <textarea id="messageInput" placeholder="输入你的消息..." rows="4"></textarea>
    <button id="sendButton">发送</button>
    <div id="responseOutput"></div>

    <script>
        // 配置变量
        const WORKER_URL = 'https://seaqllm1.seaqua.workers.dev'; // 替换为你的 Worker URL

        const VALID_MODELS = {
            '@cf/meta/llama-2-7b-chat-int8': 'Llama-2 7B',
            '@cf/mistral/mistral-7b-instruct-v0.1': 'Mistral 7B',
            '@cf/openai/gpt-3.5-turbo': 'GPT-3.5 Turbo'
        };

        // 动态填充模型选择
        const modelSelect = document.getElementById('modelSelect');
        Object.entries(VALID_MODELS).forEach(([key, name]) => {
            const option = document.createElement('option');
            option.value = key;
            option.textContent = name;
            modelSelect.appendChild(option);
        });

        document.getElementById('sendButton').onclick = async () => {
            const model = modelSelect.value;
            const message = document.getElementById('messageInput').value;
            const responseOutput = document.getElementById('responseOutput');

            responseOutput.innerText = '正在处理...';

            try {
                console.log('Sending request to:', WORKER_URL);
                const response = await fetch(WORKER_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ model, message }),
                });

                console.log('Response status:', response.status);
                const data = await response.json();
                console.log('Response data:', data);
                responseOutput.innerText = data.result || data.error || '无响应';
            } catch (error) {
                console.error('Error details:', error);
                responseOutput.innerText = '发生错误: ' + error.message;
            }
        };
    </script>
</body>
</html>
